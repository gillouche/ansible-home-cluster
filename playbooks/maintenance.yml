---
# Maintenance playbook (default without sudo). Tasks that need root use become: true.

- name: Maintenance - Pacman refresh and upgrade on Arch Linux
  hosts: all
  gather_facts: true
  become: false

  tasks:
    - name: Refresh pacman database and upgrade all packages (Arch only)
      ansible.builtin.pacman:
        update_cache: true
        upgrade: true
      become: true
      when:
        - (ansible_facts['distribution'] | lower) == 'archlinux'

    - name: Skip maintenance on non-Arch hosts
      ansible.builtin.debug:
        msg: "Skipping pacman maintenance on non-Arch host: {{ ansible_facts['distribution'] }}"
      when:
        - (ansible_facts['distribution'] | lower) != 'archlinux'
